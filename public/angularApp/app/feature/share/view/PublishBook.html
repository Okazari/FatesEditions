<div class="content-wrapper">

  <section class="content-header">
    <h1>Publier un livre</h1>
    <ol class="breadcrumb">
      <li><a ui-sref="app.play.books">MyVirtualStoryBook</a></li>
      <li class="active">Publier un livre</li>
    </ol>
  </section>
  <!-- Main content -->
  <section class="content">

    <!-- Default box -->
    <div class="box md-whiteframe-z1">
      <div class="box-body">
        <div class="box box-warning box-solid md-whiteframe-z1">
          <div class="box-header with-border">
            <h3 class="box-title">Information importante</h3>
          </div><!-- /.box-header -->
          <div class="box-body" style="display: block;">
            Publier l'un de vos brouillon créera une copie de celui-ci dans la section "Partage". Les autres membres de MyVirtualStoryBook pourrons alors trouver votre histoire dans la liste des livres jouables.
          </div><!-- /.box-body -->
        </div>
        <div class="input-group margin-top col-xs-12">
          <label>Brouillon que vous souhaitez publier</label>
          <select data-icon="fa fa-{{book.genre.icon}}" ng-change="init()" ng-model="bookToPublish" ng-options="book as book.name for book in books.list | filter:{draft:true}" class="form-control">
            <option value="" selected>-- Choisissez un brouillon à publier --</option>
          </select>
        </div>
        <div ng-show="bookToPublish" class="row margin-top">
          <div class="col-md-6">
            <div class="box box-primary md-whiteframe-z1">
              <div class="box-header with-border">
                <h3 class="box-title">Livre à publier</h3>
              </div><!-- /.box-header -->
              <div class="box-body" style="display: block;">
                <div class="row">
                  <div class="col-xs-4">
                    <img ng-src="{{bookToPublish.cover}}" class="cover-preview md-whiteframe-z1" alt="User Image">
                  </div>
                  <div class="col-xs-8">
                    <h4>{{bookToPublish.name}}</h4>
                    <h4 class="label label-danger">Brouillon<i class="fa fa-pencil genre-icon"></i></h4>
                    <h4 ng-if="bookToPublish.genre" class="label label-primary">{{bookToPublish.genre.name}} <i class="fa fa-{{bookToPublish.genre.icon}} genre-icon"></i></h4>
                    <div class="inner synopsis-preview">{{bookToPublish.synopsis}}</div>
                  </div>
                </div>
              </div><!-- /.box-body -->
            </div>
          </div>
          <div class="col-md-6">
            <div class="box box-primary md-whiteframe-z1">
              <div class="box-header with-border">
                <h3 class="box-title">Publiez le !</h3>
              </div><!-- /.box-header -->
              <div class="box-body" style="display: block;">
                <div style="text-align:center">
                   <a class="btn btn-app" ng-disabled="publishedOnce" ng-click="publishBook(bookToPublish)"><i class="fa fa-share-alt"></i>Publier {{bookToPublish.name}}</a>
                   <div class="progress active">
                      <div class="progress-bar progress-bar-{{progressBarStyle}} progress-bar-striped" role="progressbar" style="width: {{loading}}%">
                        <span class="sr-only">{{loading}}%</span>
                      </div>
                  </div>
                </div>
                <div ng-show="showError" class="box box-danger box-solid md-whiteframe-z1">
                  <div class="box-header with-border">
                    <h3 class="box-title">Format de livre incorrect</h3>
                  </div><!-- /.box-header -->
                  <div class="box-body" style="display: block;">
                    Votre livre ne peux pas être publié en l'état. Actuellement la seule raison est d'avoir oublié de définir une page de début à votre livre. Si ce n'est pas le cas merci de contacter l'administrateur.
                  </div><!-- /.box-body -->
                </div>
              </div><!-- /.box-body -->
            </div>
          </div>
        </div>
      </div><!-- /.box-body -->
      <div ng-show="booksLoading" class="overlay">
        <i class="fa fa-refresh fa-spin"></i>
      </div>
    </div><!-- /.box -->
  </section><!-- /.content -->
</div>